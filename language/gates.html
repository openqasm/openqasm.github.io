
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Gates &#8212; OpenQASM Live Specification  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/colors.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Built-in quantum instructions" href="insts.html" />
    <link rel="prev" title="Types and Casting" href="types.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="gates">
<h1>Gates<a class="headerlink" href="#gates" title="Permalink to this heading">¶</a></h1>
<p>In OpenQASM we refer to unitary quantum instructions as <em>gates</em>.</p>
<section id="applying-gates">
<h2>Applying gates<a class="headerlink" href="#applying-gates" title="Permalink to this heading">¶</a></h2>
<p>Every gate applies to a fixed number of qubits.
Assuming <code class="docutils literal notranslate"><span class="pre">g0</span></code>, <code class="docutils literal notranslate"><span class="pre">g1</span></code>, <code class="docutils literal notranslate"><span class="pre">g2</span></code>, … are gates defined on 0, 1, 2, … qubits then they can be applied as</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="n">g0</span><span class="p">;</span>
<span class="nf">g1</span><span class="w"> </span><span class="n">q1</span><span class="p">;</span>
<span class="nf">g2</span><span class="w"> </span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">;</span>
<span class="nf">g3</span><span class="w"> </span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">,</span><span class="w"> </span><span class="n">q3</span><span class="p">;</span>
</pre></div>
</div>
<section id="broadcasting">
<h3>Broadcasting<a class="headerlink" href="#broadcasting" title="Permalink to this heading">¶</a></h3>
<p>If any arguments of a gate are quantum registers instead of qubits, then all such registers must be <strong>of the same length</strong> and
this syntax is a convenient shorthand for broadcasting over the qubits of the register. For example, the circuit</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="kt">qubit</span><span class="w"> </span><span class="n">qr0</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
<span class="kt">qubit</span><span class="w"> </span><span class="n">qr1</span><span class="p">[</span><span class="m">3</span><span class="p">];</span>
<span class="kt">qubit</span><span class="w"> </span><span class="n">qr2</span><span class="p">[</span><span class="m">2</span><span class="p">];</span>
<span class="kt">qubit</span><span class="w"> </span><span class="n">qr3</span><span class="p">[</span><span class="m">3</span><span class="p">];</span>

<span class="nf">g4</span><span class="w"> </span><span class="n">qr0</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">qr1</span><span class="p">,</span><span class="w"> </span><span class="n">qr2</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">qr3</span><span class="p">;</span><span class="w"> </span><span class="c1">// ok</span>
<span class="nf">g4</span><span class="w"> </span><span class="n">qr0</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">qr2</span><span class="p">,</span><span class="w"> </span><span class="n">qr1</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">qr3</span><span class="p">;</span><span class="w"> </span><span class="c1">// error! qr2 and qr3 differ in size</span>
</pre></div>
</div>
<p>has a second-to-last line that is equivalent to</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>g4 qr0[0], qr1[0], qr2[0], qr3[0];
g4 qr0[0], qr1[1], qr2[0], qr3[1];
g4 qr0[0], qr1[2], qr2[0], qr3[2];
</pre></div>
</div>
<p>Use of this syntax constitutes a promise to the compiler that the expanded set of broadcasted gates
is mutually commuting and thus the compiler can take advantage of the opportunity to reorder the
gates freely for optimization purposes. In certain cases a compiler might be able to detect a
non-commutativity and raise a warning, but it is not required to do so in all cases. If the gates do
not commute and a specific order is required by the programmer, than a <code class="docutils literal notranslate"><span class="pre">for</span></code> loop may be used to
set that order.</p>
</section>
<section id="parameterized-gates">
<h3>Parameterized gates<a class="headerlink" href="#parameterized-gates" title="Permalink to this heading">¶</a></h3>
<p>As well as gates that each represent a fixed unitary, OpenQASM also supports gates that represent <em>families</em> of unitaries, parameterized
by angle variables. To distinguish the (optional) angle parameters from the (required) quantum arguments, if any angle parameters are
present they must appear before any quantum arguments, and be delimited by parentheses. For example</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>fsim(θ, ϕ) q[0], q[1];
</pre></div>
</div>
</section>
</section>
<section id="defining-gates">
<h2>Defining gates<a class="headerlink" href="#defining-gates" title="Permalink to this heading">¶</a></h2>
<p>There are 3 mechanisms to construct new gates:</p>
<ol class="arabic simple">
<li><p>A new named gate can be introduced by a  <strong>hierarchical definition</strong> from a sequence of existing gates;</p></li>
<li><p>Anonymous new gates may be defined by applying <strong>gate modifiers</strong> to existing gates;</p></li>
<li><p>The <strong>built-in gates</strong> comprising the one-qubit gate <code class="docutils literal notranslate"><span class="pre">U(θ,</span> <span class="pre">ϕ,</span> <span class="pre">λ)</span></code> and the zero-qubit gate <code class="docutils literal notranslate"><span class="pre">gphase(γ)</span></code>.
The definitions of these gates is part of the language specification.</p></li>
</ol>
<p>The next subsections go through these cases.</p>
<section id="hierarchical-gates-definitions">
<h3>Hierarchical gates definitions<a class="headerlink" href="#hierarchical-gates-definitions" title="Permalink to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">gate</span></code> statement associates an identifier with a corresponding unitary matrix (or parameterized family)
transformation by a sequence of other (built-in or previously-defined) gates.</p>
<p>For example the <code class="docutils literal notranslate"><span class="pre">gate</span></code> block</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="kd">gate</span><span class="w"> </span><span class="nf">h</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="nb">U</span><span class="p">(</span><span class="no">π</span><span class="o">/</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="no">π</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">   </span><span class="nb">gphase</span><span class="w"> </span><span class="o">-</span><span class="no">π</span><span class="o">/</span><span class="m">4</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>defines a new gate called <code class="docutils literal notranslate"><span class="pre">h</span></code> and associates it to the unitary matrix of the Hadamard gate. Once we have
defined <code class="docutils literal notranslate"><span class="pre">h</span></code>, we can use it in later <code class="docutils literal notranslate"><span class="pre">gate</span></code> blocks.</p>
<p>The definition does not imply that <code class="docutils literal notranslate"><span class="pre">h</span></code> is
implemented by an instruction <code class="docutils literal notranslate"><span class="pre">U(π/2,</span> <span class="pre">0,</span> <span class="pre">π)</span></code> on the quantum computer. The implementation is up to
the user and/or compiler, given information about the instructions supported by a particular target.
A minimal compiler implementation might simply expand <code class="docutils literal notranslate"><span class="pre">gate</span></code> definitions repeatedly until reaching
definitions for which <a class="reference internal" href="pulses.html#pulse-gates"><span class="std std-ref">defcal blocks</span></a> are known. A more sophisticated implementation
might use the <cite>gate</cite> definitions of the gates with associated <code class="docutils literal notranslate"><span class="pre">defcal</span></code> blocks to
build a gate library, and use methods based on KAK decompositions to rewrite into this hardware library.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">gate</span></code> statement also allows defining parameterized families of unitaries. For example, a CPHASE
operation is shown schematically in <a class="reference internal" href="#fig-gate"><span class="std std-numref">Fig. 1</span></a>
and the corresponding OpenQASM code is</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="kd">gate</span><span class="w"> </span><span class="nf">cphase</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span>
<span class="p">{</span>
<span class="w">  </span><span class="nb">U</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">θ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="nf">CX</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="nb">U</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="n">θ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="nf">CX</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="w">  </span><span class="nb">U</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="n">θ</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="p">}</span>
<span class="nf">cphase</span><span class="p">(</span><span class="no">π</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">q</span><span class="p">[</span><span class="m">1</span><span class="p">];</span>
</pre></div>
</div>
<figure class="align-default" id="id3">
<span id="fig-gate"></span><img alt="../_images/gate.svg" src="../_images/gate.svg" /><figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">New gates are defined from previously defined gates. The gates are applied using the statement
<code class="docutils literal notranslate"><span class="pre">name(params)</span> <span class="pre">qargs;</span></code> The parentheses are optional if there
are no parameters. The gate <span class="math notranslate nohighlight">\({cphase}(\theta)\)</span> corresponds to the unitary matrix
<span class="math notranslate nohighlight">\({diag}(1,1,1,e^{i\theta})\)</span> up to a global phase.</span><a class="headerlink" href="#id3" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>Again, this definition does not imply that <code class="docutils literal notranslate"><span class="pre">cphase</span></code> must be implemented with
this particular series of gates. Rather, we have specified the unitary
transformation that corresponds to the symbol <code class="docutils literal notranslate"><span class="pre">cphase</span></code>. The particular
implementation is up to the compiler, given information about the basis
gate set supported by a particular target.</p>
<p>In general, new gates are defined by statements of the form</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="kd">gate</span><span class="w"> </span><span class="nf">name</span><span class="p">(</span><span class="n">params</span><span class="p">)</span><span class="w"> </span><span class="n">qargs</span>
<span class="p">{</span>
<span class="w">  </span><span class="n">body</span>
<span class="p">}</span>
</pre></div>
</div>
<p>where the optional parameter list <code class="docutils literal notranslate"><span class="pre">params</span></code> is a comma-separated list of variable
parameters, and the argument list <code class="docutils literal notranslate"><span class="pre">qargs</span></code> is a comma-separated list of qubit
arguments. The parameters are identifiers that behave as <code class="docutils literal notranslate"><span class="pre">angle</span></code> type with unknown
size. A compiler might recognize certain constructs and replace them with mathematically-
equivalent versions that would be true for arbitrary precision, or it might do calculations
at a fixed <code class="docutils literal notranslate"><span class="pre">angle</span></code> size, for example corresponding to the size of <code class="docutils literal notranslate"><span class="pre">angle</span></code> parameters in the corresponding
<code class="docutils literal notranslate"><span class="pre">defcal</span></code> definitions.</p>
<p>The qubit arguments are identifiers. If there are no
variable parameters, the parentheses are optional. The arguments in <code class="docutils literal notranslate"><span class="pre">qargs</span></code> cannot be indexed within the body
of the gate definition.</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="c1">// this is ok:</span>
<span class="kd">gate</span><span class="w"> </span><span class="nf">g</span><span class="w"> </span><span class="n">a</span>
<span class="p">{</span>
<span class="w">  </span><span class="nb">U</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// this is invalid:</span>
<span class="kd">gate</span><span class="w"> </span><span class="nf">g</span><span class="w"> </span><span class="n">a</span>
<span class="p">{</span>
<span class="w">  </span><span class="nb">U</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">)</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">];</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Only built-in gate statements and calls to previously defined gates can appear in <code class="docutils literal notranslate"><span class="pre">body</span></code>.
For example, it is not valid to
declare a classical register in a gate body. Looping constructs over these quantum
statements are valid.</p>
<p>The statements in the body
can only refer to the symbols given in the parameter or argument list,
and these symbols are scoped only to the subroutine body.</p>
<p>An empty body corresponds to the identity gate.</p>
<p>To avoid infinite recursion, gates must be declared before use and
cannot call themselves. The statement <code class="docutils literal notranslate"><span class="pre">name(params)</span> <span class="pre">qargs;</span></code> applies the gate,
and the variable parameters <code class="docutils literal notranslate"><span class="pre">params</span></code> can have any type that can promote to <code class="docutils literal notranslate"><span class="pre">angle</span></code> type.</p>
</section>
<section id="quantum-gate-modifiers">
<h3>Quantum gate modifiers<a class="headerlink" href="#quantum-gate-modifiers" title="Permalink to this heading">¶</a></h3>
<p>A gate modifier is a keyword that applies to a gate. A modifier
<span class="math notranslate nohighlight">\(m\)</span> transforms a gate <span class="math notranslate nohighlight">\(U\)</span> to a new gate <span class="math notranslate nohighlight">\(m(U)\)</span> acting
on the same or larger Hilbert space. We include modifiers in OpenQASM
both for programming convenience and compiler analysis.</p>
<section id="control-modifiers">
<h4>Control modifiers<a class="headerlink" href="#control-modifiers" title="Permalink to this heading">¶</a></h4>
<p>The modifier <code class="docutils literal notranslate"><span class="pre">ctrl</span> <span class="pre">&#64;</span></code> replaces its gate argument <span class="math notranslate nohighlight">\(U\)</span> by a
controlled-<span class="math notranslate nohighlight">\(U\)</span> gate. If the control bit is 0, nothing happens to the target bit.
If the control bit is 1, <span class="math notranslate nohighlight">\(U\)</span> acts on the target bit. Mathematically, the controlled-<span class="math notranslate nohighlight">\(U\)</span>
gate is defined as <span class="math notranslate nohighlight">\(C_U = I \otimes U^c\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> is the integer value of the control
bit and <span class="math notranslate nohighlight">\(C_U\)</span> is the controlled-<span class="math notranslate nohighlight">\(U\)</span> gate. The new quantum argument is prepended to the
argument list for the controlled-<span class="math notranslate nohighlight">\(U\)</span> gate. The quantum argument can be a register, and in this
case controlled gate broadcast over it (as for all gates). The modified
gate does not use any additional scratch space and may require compilation to be executed.</p>
<p>As a limiting case, the controlled <em>global</em> phase gate
<code class="docutils literal notranslate"><span class="pre">ctrl</span> <span class="pre">&#64;</span> <span class="pre">gphase(a)</span></code> is equivalent to the single-qubit gate <code class="docutils literal notranslate"><span class="pre">U(0,</span> <span class="pre">0,</span> <span class="pre">a)</span></code>.</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define a controlled Rz operation using the ctrl gate modifier.</span>
<span class="c1">// q1 is control, q2 is target</span>
<span class="kd">gate</span><span class="w"> </span><span class="nf">crz</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">ctrl</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">rz</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The modifier <code class="docutils literal notranslate"><span class="pre">negctrl</span> <span class="pre">&#64;</span></code> generates controlled gates with negative polarity, ie conditioned on a
controlled value of 0 rather than 1. Mathematically, the negative controlled-<span class="math notranslate nohighlight">\(U\)</span> gate is
given by <span class="math notranslate nohighlight">\(N_U = I \otimes U^{1-c}\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> is the integer value of the control bit
and <span class="math notranslate nohighlight">\(N_U\)</span> is the negative controlled-<span class="math notranslate nohighlight">\(U\)</span> gate.</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define a negative controlled X operation using the negctrl gate modifier.</span>
<span class="c1">// q1 is control, q2 is target</span>
<span class="kd">gate</span><span class="w"> </span><span class="nf">neg_cx</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">negctrl</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">x</span><span class="w"> </span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ctrl</span></code> and <code class="docutils literal notranslate"><span class="pre">negctrl</span></code> both accept an optional positive integer parameter <code class="docutils literal notranslate"><span class="pre">n</span></code>, specifying the
number of control arguments (omission means <code class="docutils literal notranslate"><span class="pre">n=1</span></code>). <code class="docutils literal notranslate"><span class="pre">n</span></code> must be a compile-time constant. For an <code class="docutils literal notranslate"><span class="pre">N</span></code>
qubit operation,these operations are mathematically defined as</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}C^n_U = I_1 \otimes I_2 ... \otimes I_n \otimes U^{c_1*c_2*...*c_n}\\N^n_U = I_1 \otimes I_2 ... \otimes I_n \otimes U^{1 - c_1*c_2*...*c_n}\end{aligned}\end{align} \]</div>
<p>where <span class="math notranslate nohighlight">\(c_1\)</span>, <span class="math notranslate nohighlight">\(c_2\)</span>, …, <span class="math notranslate nohighlight">\(c_n\)</span> are the integer values of the control bits and
<span class="math notranslate nohighlight">\(C^n_U\)</span> are the n-bit controlled-<span class="math notranslate nohighlight">\(U\)</span> and n-bit negative controlled-<span class="math notranslate nohighlight">\(U\)</span> gates,
respectively.</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="c1">// A reversible boolean function</span>
<span class="c1">// Demonstrates use of ``ctrl(n) @`` and ``negctrl(n) @``</span>
<span class="kt">qubit</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="kt">qubit</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="n">b</span><span class="p">;</span>
<span class="kt">qubit</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="ow">reset</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="nb">ctrl</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">x</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="nb">negctrl</span><span class="p">(</span><span class="m">3</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nb">ctrl</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">x</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="nb">negctrl</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nb">ctrl</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nb">negctrl</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">x</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">2</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
<span class="nb">negctrl</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nb">ctrl</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">x</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="m">1</span><span class="p">],</span><span class="w"> </span><span class="n">a</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="m">0</span><span class="p">],</span><span class="w"> </span><span class="n">f</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="inverse-modifier">
<h4>Inverse modifier<a class="headerlink" href="#inverse-modifier" title="Permalink to this heading">¶</a></h4>
<p>The modifier <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">&#64;</span> <span class="pre">U</span></code> replaces its gate argument <span class="math notranslate nohighlight">\(U\)</span> with its inverse
<span class="math notranslate nohighlight">\(U^\dagger\)</span>. This can be computed from gate <span class="math notranslate nohighlight">\(U\)</span> via the following rules</p>
<ul class="simple">
<li><p>The inverse of any gate <span class="math notranslate nohighlight">\(U=U_m U_{m-1} ... U_1\)</span> can be defined recursively by reversing the
order of the gates in its definition and replacing each of those with their inverse
<span class="math notranslate nohighlight">\(U^\dagger = U_1^\dagger U_2^\dagger ... U_m^\dagger\)</span>.</p></li>
<li><p>The inverse of a controlled operation is defined by inverting the control unitary. That is,
<code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">&#64;</span> <span class="pre">ctrl</span> <span class="pre">&#64;</span> <span class="pre">U</span> <span class="pre">=</span> <span class="pre">ctrl</span> <span class="pre">&#64;</span> <span class="pre">inv</span> <span class="pre">&#64;</span> <span class="pre">U</span></code>.</p></li>
<li><p>The base case is given by replacing <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">&#64;</span> <span class="pre">U(θ,</span> <span class="pre">ϕ,</span> <span class="pre">λ)</span></code> by <code class="docutils literal notranslate"><span class="pre">U(-θ,</span> <span class="pre">-λ,</span> <span class="pre">-ϕ)</span></code>
and <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">&#64;</span> <span class="pre">gphase(a)</span></code> by <code class="docutils literal notranslate"><span class="pre">gphase(-a)</span></code>.</p></li>
</ul>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="c1">// Define a negative z rotation and the inverse of a positive z rotation</span>
<span class="kd">gate</span><span class="w"> </span><span class="nf">rzm</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">inv</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">rzp</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">q1</span><span class="p">;</span>
<span class="p">}</span>
<span class="c1">// Equivalently, this can be written as</span>
<span class="kd">gate</span><span class="w"> </span><span class="nf">rzm</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nf">rzp</span><span class="p">(</span><span class="o">-</span><span class="n">θ</span><span class="p">)</span><span class="w"> </span><span class="n">q1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="power-modifier">
<h4>Power modifier<a class="headerlink" href="#power-modifier" title="Permalink to this heading">¶</a></h4>
<p>The modifier <code class="docutils literal notranslate"><span class="pre">pow(k)</span> <span class="pre">&#64;</span></code> replaces its gate argument <span class="math notranslate nohighlight">\(U\)</span> by its <span class="math notranslate nohighlight">\(k\)</span>th
power <span class="math notranslate nohighlight">\(U^k\)</span> for some positive integer or floating point number <span class="math notranslate nohighlight">\(k\)</span> (not necessarily
constant). In the case that <span class="math notranslate nohighlight">\(k\)</span> is an integer, the gate can be implemented (albeit
inefficiently) by <span class="math notranslate nohighlight">\(k\)</span> repetitions of <span class="math notranslate nohighlight">\(U\)</span> for <span class="math notranslate nohighlight">\(k &gt; 0\)</span> and <span class="math notranslate nohighlight">\(k\)</span>
repetitions of <code class="docutils literal notranslate"><span class="pre">inv</span> <span class="pre">&#64;</span> <span class="pre">U</span></code> for <span class="math notranslate nohighlight">\(k &lt; 0\)</span>.</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="c1">// define x as the square of sqrt(x) ``sx`` gate</span>
<span class="kd">gate</span><span class="w"> </span><span class="nf">x</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nb">pow</span><span class="p">(</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">sx</span><span class="w"> </span><span class="n">q1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="built-in-gates">
<h3>Built-in gates<a class="headerlink" href="#built-in-gates" title="Permalink to this heading">¶</a></h3>
<section id="built-in-single-qubit-gate-u">
<h4>Built-in single-qubit gate <code class="docutils literal notranslate"><span class="pre">U</span></code><a class="headerlink" href="#built-in-single-qubit-gate-u" title="Permalink to this heading">¶</a></h4>
<p>The built-in single-qubit gate <code class="docutils literal notranslate"><span class="pre">U(θ,</span> <span class="pre">ϕ,</span> <span class="pre">λ)</span></code> represents the unitary matrix</p>
<div class="math notranslate nohighlight">
\[\begin{split}U(\theta,\phi,\lambda) := \frac{1}{2}\left(\begin{array}{cc}
   1+e^{i\theta} &amp; -ie^{i\lambda}(1-e^{i\theta}) \\
   ie^{i\phi}(1-e^{i\theta}) &amp; e^{i(\phi+\lambda)}(1+e^{i\theta}) \end{array}\right).\end{split}\]</div>
<p>This definition is <span class="math notranslate nohighlight">\(2\pi\)</span>-periodic in each of the parameters θ, ϕ, λ and
specifies any element of <span class="math notranslate nohighlight">\(U(2)\)</span> up to a
global phase <a class="footnote-reference brackets" href="#uphase" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> . For example <code class="docutils literal notranslate"><span class="pre">U(π/2,</span> <span class="pre">0,</span> <span class="pre">π)</span> <span class="pre">q[0];</span></code>, applies a Hadamard gate to qubit <code class="docutils literal notranslate"><span class="pre">q[0]</span></code>
(up to a non-standard global phase).</p>
</section>
<section id="global-phase-gate-gphase">
<h4>Global phase gate <code class="docutils literal notranslate"><span class="pre">gphase</span></code><a class="headerlink" href="#global-phase-gate-gphase" title="Permalink to this heading">¶</a></h4>
<p>From a physical perspective, the unitaries <span class="math notranslate nohighlight">\(e^{i\gamma}V\)</span> and <span class="math notranslate nohighlight">\(V\)</span> are equivalent although they differ by a global
phase <span class="math notranslate nohighlight">\(e^{i\gamma}\)</span>. When we add a control to these gates, however, the global phase becomes a relative phase
that is applied when the control qubit is one. A built-in global phase gate
allows the inclusion of arbitrary global phases on circuits. The instruction <code class="docutils literal notranslate"><span class="pre">gphase(γ);</span></code> accumulates a global phase
of <span class="math notranslate nohighlight">\(e^{i\gamma}\)</span>.</p>
<p>Just as every n-qubit gate can be thought of as generating a tensor product with the suitable
identity matrix to cover all other qubits in the gate, subroutine, or global scope containing the
instruction, similarly <code class="docutils literal notranslate"><span class="pre">gphase</span></code> behaves as a 0-qubit gate and when applied in a context with
<cite>m</cite> qubits in scope, behaves as applying the unitary</p>
<div class="math notranslate nohighlight">
\[\operatorname{gphase}(\gamma) := e^{i\gamma} I_m,\]</div>
<p>where <span class="math notranslate nohighlight">\(I_m\)</span> denotes the identity matrix with size <span class="math notranslate nohighlight">\(2^m\)</span></p>
<p>For example</p>
<div class="highlight-qasm3 notranslate"><div class="highlight"><pre><span></span><span class="kd">gate</span><span class="w"> </span><span class="nf">X</span><span class="w"> </span><span class="n">q</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="nb">U</span><span class="p">(</span><span class="no">π</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="no">π</span><span class="p">)</span><span class="w"> </span><span class="n">q</span><span class="p">;</span>
<span class="w">   </span><span class="nb">gphase</span><span class="w"> </span><span class="o">-</span><span class="no">π</span><span class="o">/</span><span class="m">2</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">gate</span><span class="w"> </span><span class="nf">CX</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="p">{</span>
<span class="w">   </span><span class="nb">ctrl</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="nf">X</span><span class="w"> </span><span class="n">c</span><span class="p">,</span><span class="w"> </span><span class="n">t</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>defines <code class="docutils literal notranslate"><span class="pre">CX</span></code> as the standard CNOT gate.</p>
</section>
</section>
</section>
<section id="relation-of-the-built-in-gates-to-hardware-native-gates">
<h2>Relation of the built-in gates to hardware-native gates<a class="headerlink" href="#relation-of-the-built-in-gates-to-hardware-native-gates" title="Permalink to this heading">¶</a></h2>
<p>For <em>non-parameterized gates</em>, the choice of <code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">gphase</span></code> as the built-in gates, along with one
two-qubit entangling gate CNOT as defined gives a universal gate set that can represent general n-qubit
unitaries with an <span class="math notranslate nohighlight">\(O(2^n)\)</span> size description <span id="id2">[<a class="reference internal" href="../index.html#id45" title="A. Barenco, C. Bennett, R. Cleve, D. DiVincenzo, N. Margolus, P. Shor, T. Sleator, J. Smolin, and H. Weinfurter. Elementary gates for quantum computation. Phys. Rev. A, 1995.">BBC+95</a>]</span>. This basis is not an enforced compilation
target but a mechanism to define other gates. For many gates of
practical interest, there is a circuit representation with a polynomial
number of one- and two-qubit gates, giving a more compact representation
than requiring the programmer to express the full <span class="math notranslate nohighlight">\(2^n \times 2^n\)</span>
matrix. However, a general <span class="math notranslate nohighlight">\(n\)</span>-qubit gate can be defined using an
exponential number of these gates. Thus there is no particular privilege incurred by hardware implementations
that natively support the built-in gates.</p>
<p>For <em>parameterized gates</em>, the choice of built-in gates <em>does</em> constrain which hardware-native gates are well-
supported, because conversion between parameterized basis sets in general can be involved, requiring careful
selection of branch cuts and other logic that would not likely be feasible to specify as compact mathematical
expressions, nor to evaluate at runtime for cases where the parameters depend on quantum measurements.</p>
<p>For many current platforms the qubits are defined relative to a
rotating frame and the rotating wave approximation (RWA) holds. This is the domain covered by the OpenPulse
specification. For this case, the only supported form of run-time parameterization
will likely be via a <code class="docutils literal notranslate"><span class="pre">rz(ϕ)</span></code> implemented by specialized frame-tracking hardware.
This gate is covered by the built-in <code class="docutils literal notranslate"><span class="pre">U</span></code> as a special case <code class="docutils literal notranslate"><span class="pre">U(0,</span> <span class="pre">0,</span> <span class="pre">ϕ)</span></code>
However, if other forms of run-time parameterization become important, it may be necessary to revise OpenQASM,
to give meaning to those gates, for example by adding new basis gates or additional <code class="docutils literal notranslate"><span class="pre">gate</span></code> definition syntax.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="uphase" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">1</a><span class="fn-bracket">]</span></span>
<p>This definition of <code class="docutils literal notranslate"><span class="pre">U</span></code> has a different global phase from previous versions of the OpenQASM spec.
Unfortunately the original definitions were 4π rather than 2π periodic in the θ parameter. A gate
<code class="docutils literal notranslate"><span class="pre">U_old(0,</span> <span class="pre">ϕ,</span> <span class="pre">θ)</span> <span class="pre">q;</span></code> under the previous definition corresponds to <code class="docutils literal notranslate"><span class="pre">U(0,</span> <span class="pre">ϕ,</span> <span class="pre">θ)</span> <span class="pre">q;</span> <span class="pre">gphase(-0/2);</span></code> with the present
definition.</p>
</aside>
</aside>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">OpenQASM Live Specification</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Language</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="comments.html">Comments</a></li>
<li class="toctree-l2"><a class="reference internal" href="comments.html#version-string">Version string</a></li>
<li class="toctree-l2"><a class="reference internal" href="comments.html#included-files">Included files</a></li>
<li class="toctree-l2"><a class="reference internal" href="types.html">Types and Casting</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Gates</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#applying-gates">Applying gates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-gates">Defining gates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relation-of-the-built-in-gates-to-hardware-native-gates">Relation of the built-in gates to hardware-native gates</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="insts.html">Built-in quantum instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="classical.html">Classical instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="subroutines.html">Subroutines</a></li>
<li class="toctree-l2"><a class="reference internal" href="scope.html">Scoping of variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="directives.html">Directives</a></li>
<li class="toctree-l2"><a class="reference internal" href="directives.html#input-output">Input/output</a></li>
<li class="toctree-l2"><a class="reference internal" href="delays.html">Circuit timing</a></li>
<li class="toctree-l2"><a class="reference internal" href="pulses.html">Pulse-level descriptions of gates and measurement</a></li>
<li class="toctree-l2"><a class="reference internal" href="openpulse.html">OpenPulse Grammar</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../grammar/index.html">OpenQasm 3.0 Grammar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release Notes</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Language</a><ul>
      <li>Previous: <a href="types.html" title="previous chapter">Types and Casting</a></li>
      <li>Next: <a href="insts.html" title="next chapter">Built-in quantum instructions</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017-2020, Andrew W. Cross, Lev S. Bishop, John A. Smolin, Jay M. Gambetta.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 6.1.3</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/language/gates.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>